<!DOCTYPE html>
{% load staticfiles %}

<html lang="en" style="height:100%;">
    <head>
        {% include "header.html" %}
        <link   rel="stylesheet" 
                href="{% static "bower_components/bootstrap/dist/css/bootstrap.min.css" %}">
        <script src="http://maps.google.com/maps/api/js?sensor=false" 
                type="text/javascript"></script>
    </head>
    
    <body style="width:100%; min-height:100%;">
        {% block nav_bar %}{% endblock %}
        <div id="bodyContainer" style="width:100%; height:800px; margin-top:-20px;">
            <div id="filterContainer" style="background-color:lightgrey; width:100%; height:70px; padding-top:22px; padding-bottom:10px; text-align:center; border-style:inset; border-width:1px; border-right-width:0px; border-left-width:0px; border-color:lightgrey;">
                <button id="cost_low" onclick="sort_cost_low()" style="margin-right:5px;">Cost Low to High</button>

                <button id="cost_high" onclick="sort_cost_high()" style="margin-right:5px; margin-left:5px;">Cost High To Low</button>

                <button id="dist_low" onclick="sort_dist_low()" style="margin-right:5px; margin-left:5px;">Distance Low to High</button>

                <button id="dist_high" onclick="sort_dist_high()" style="margin-left:5px;">Distance High to Low</button>
                
                <FORM NAME="amenities" style="display:inline-block; margin-left:30px;">
                    <INPUT TYPE="checkbox" id="grill" name="grill" onClick="filter_grill()" style="display:inline-block;" /> 
                    <label for="grill" style="display:inline-block; vertical-align:middle; margin-right:10px;">Grill</label>

                    <INPUT TYPE="checkbox" id="bathroom" name="bathroom" onClick="filter_bathroom()" style="display:inline-block;" />
                    <label for="bathroom" style="display:inline-block; vertical-align:middle; margin-right:10px;">Bathroom</label>

                    <INPUT TYPE="checkbox" id="yard" name="yard" onClick="filter_yard()" style="display:inline-block;" />
                    <label for="yard" style="display:inline-block; vertical-align:middle; margin-right:10px;">Yard</label>

                    <INPUT TYPE="checkbox" id="table" name="table" onClick="filter_table" style="display:inline-block;" />
                    <label for="table" style="display:inline-block; vertical-align:middle; margin-right:10px;">Table</label>

                    <INPUT TYPE="checkbox" id="electricity" name="electricity" onClick="filter_electricity" style="display:inline-block;" /> 
                    <label for="electricity" style="display:inline-block; vertical-align:middle; margin-right:10px;">Electricity</label>
                </FORM>
                <!--<button id="filter_grill" onclick="filter_grill()">Filter By Grill</button>
                <button id="filter_bathroom" onclick="filter_bathroom()">Filter By Bathroom</button>
                <button id="filter_yard" onclick="filter_yard()">Filter By Yard</button>
                <button id="filter_table" onclick="filter_table()">Filter By Table</button>
                <button id="filter_electricity" onclick="filter_electricity()">Filter By Electricity</button>-->
            </div>

            <div id="mapContainer" style="width:45%; height:100%; margin-top:1px; float:right;">
                <div id="map" style="height:100%; width:100%;"></div>

                <!-- Script to implement googe maps block -->
                <script>    
                    var map = new google.maps.Map(document.getElementById('map'), {
                            zoom: 10,
                            center: new google.maps.LatLng({{center_lon}},{{center_lat}}),
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                    });
                    
                    var infowindow = new google.maps.InfoWindow();
                    var parkingspots = {{ json_parkingspots|safe }};
                    var i, marker;
                   
                    for (i = 0; i < parkingspots.length; i++) {
                           marker = new google.maps.Marker({
                           position: new google.maps.LatLng(parkingspots[i].location.longitude, parkingspots[i].location.latitude),
                           map: map
                        });
                    
                        google.maps.event.addListener(marker, 'click', (function(marker, i) {
                            return function() {
                            infowindow.setContent('<h5>'+parkingspots[i].street_address+'</h5></br>' +
                                                  '<p>' + parkingspots[i].description+'</p>'
                                                  );
                            infowindow.open(map, marker);
                            }
                        })(marker, i));
                    }
                </script>
            </div>
            
            <div id="parkingSpotsContainer" style="width:50%; height:100%; float:left; padding-top:10px; padding-left:20px;">
                <div id="parkingContainer">
                    {% for x in parkingspots %}
                        <div class="row">
                            <section class="col-xs-6 col-sm-6 col-md-4 col-lg-2">
                                <h3>{{ x.street_address }}</h3>
                                <p>{{ x.description }}</p>
                            </section>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Prints footer -->
        {% include "footer.html" %}

        <!--
        Script to implement Filter functions:

        1) Sort by Low Cost First
        2) Sort by High Cost First
        3) Sort by Closest Distance
        4) Sort by Furthest Distance
        5) Sort by Grill Availability
        6) Sort by Bathroom Availability
        7) Sort by Yard availability
        8) Sort by Table availability
        9) Sort by Electricity availability
        -->
        <script type="text/javascript">
            function sort_cost_low() {
                var parkingspots = {{ json_parkingspots|safe }};
                parkingspots.sort(sort_by_low_cost);
                var content = "";
                for (i = 0; i < parkingspots.length; i++) {
                    content += "<div class='row'>";
                    content += "<section class='col-xs-6 col-sm-6 col-md-4 col-lg-2'>";
                    content += "<h3>" + parkingspots[i].street_address + "</h3>";
                    content += "<p>" + parkingspots[i].description + "</p>";
                    content += "</section>";
                    content += "</div>";
                }
                document.getElementById("parkingContainer").innerHTML = content;
            }
            function sort_cost_high() {
                var parkingspots = {{ json_parkingspots|safe }};
                parkingspots.sort(sort_by_high_cost);
                var content = "";
                for (i = 0; i < parkingspots.length; i++) {
                    content += "<div class='row'>";
                    content += "<section class='col-xs-6 col-sm-6 col-md-4 col-lg-2'>";
                    content += "<h3>" + parkingspots[i].street_address + "</h3>";
                    content += "<p>" + parkingspots[i].description + "</p>";
                    content += "</section>";
                    content += "</div>";
                }
                document.getElementById("parkingContainer").innerHTML = content;
            }
            function sort_dist_low() {
                var parkingspots = {{ json_parkingspots|safe }};
                parkingspots.sort(sort_by_low_distance);
                var content = "";
                for (i = 0; i < parkingspots.length; i++) {
                    content += "<div class='row'>";
                    content += "<section class='col-xs-6 col-sm-6 col-md-4 col-lg-2'>";
                    content += "<h3>" + parkingspots[i].street_address + "</h3>";
                    content += "<p>" + parkingspots[i].description + "</p>";
                    content += "</section>";
                    content += "</div>";
                }
                document.getElementById("parkingContainer").innerHTML = content;
            }
            function sort_dist_high() {
                var parkingspots = {{ json_parkingspots|safe }};
                parkingspots.sort(sort_by_high_distance);
                var content = "";
                for (i = 0; i < parkingspots.length; i++) {
                    content += "<div class='row'>";
                    content += "<section class='col-xs-6 col-sm-6 col-md-4 col-lg-2'>";
                    content += "<h3>" + parkingspots[i].street_address + "</h3>";
                    content += "<p>" + parkingspots[i].description + "</p>";
                    content += "</section>";
                    content += "</div>";
                }
                document.getElementById("parkingContainer").innerHTML = content;
            }
            function filter_grill() {
                var parkingspots = {{ json_parkingspots|safe }};
                new_list = parkingspots.filter(filter_by_grill);
                var content = "";
                for (i = 0; i < new_list.length; i++) {
                    content += JSON.stringify(new_list[i]);
                    content += "<br/>";
                }
                document.getElementById("grill").innerHTML = content;
            }
            function filter_bathroom() {
                var parkingspots = {{ json_parkingspots|safe }};
                new_list = parkingspots.filter(filter_by_bathroom);
                var content = "";
                for (i = 0; i < new_list.length; i++) {
                    content += JSON.stringify(new_list[i]);
                    content += "<br/>";
                }
                document.getElementById("bathroom").innerHTML = content;
            }
            function filter_yard() {
                var parkingspots = {{ json_parkingspots|safe }};
                new_list = parkingspots.filter(filter_by_yard);
                var content = "";
                for (i = 0; i < new_list.length; i++) {
                    content += JSON.stringify(new_list[i]);
                    content += "<br/>";
                }
                document.getElementById("yard").innerHTML = content;
            }
            function filter_table() {
                var parkingspots = {{ json_parkingspots|safe }};
                new_list = parkingspots.filter(filter_by_table);
                var content = "";
                for (i = 0; i < new_list.length; i++) {
                    content += JSON.stringify(new_list[i]);
                    content += "<br/>";
                }
                document.getElementById("table").innerHTML = content;
            }
            function filter_electricity() {
                var parkingspots = {{ json_parkingspots|safe }};
                new_list = parkingspots.filter(filter_by_electricity);
                var content = "";
                for (i = 0; i < new_list.length; i++) {
                    content += JSON.stringify(new_list[i]);
                    content += "<br/>";
                }
                document.getElementById("electricity").innerHTML = content;
            }
        </script>

        <script src="{% static "bower_components/jquery/dist/jquery.min.js" %}"></script>
        <script src="{% static "bower_components/bootstrap/dist/js/bootstrap.min.js" %}"></script>
        <script src="{% static "js/parking_sort.js" %}"></script>
    </body>
    
</html>
